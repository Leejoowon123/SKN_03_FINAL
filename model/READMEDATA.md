# 뮤지컬 추천 시스템 데이터 명세서

## 목차
1. [사용 더미 데이터 파일](#더미-데이터-파일)
2. [데이터베이스 스키마](#데이터베이스-스키마)
3. [전처리 결과](#전처리-결과)
4. [데이터 요구사항](#데이터-요구사항)
5. [예매율 계산](#예매율-계산-방법)
## 더미 데이터 파일

### 1. Musical_Data.csv
기본 뮤지컬 정보를 담고 있는 파일
```
Musical_Data.csv
├── 뮤지컬 제목 (String)
├── 관람일 (Date: YYYY-MM-DD)
├── 시작 시간 (Time: HH:MM)
├── 종료 시간 (Time: HH:MM)
├── 공연 시설명 (String)
├── 공연장 최대 수용 수 (Integer)
├── 티켓 가격 (Integer)
├── 줄거리 (Text)
└── 공연 장르명 (String)
```
#### 컬럼 설명
| 컬럼명 | 데이터 타입 | 설명 | 예시 |
|--------|------------|------|------|
| 뮤지컬 제목 | String | 뮤지컬의 고유 제목 | "Musical_1" |
| 관람일 | Date | YYYY-MM-DD 형식의 공연 날짜 | "2024-12-13" |
| 시작 시간 | Time | HH:MM 형식의 공연 시작 시간 | "14:00" |
| 종료 시간 | Time | HH:MM 형식의 공연 종료 시간 | "16:30" |
| 공연 시설명 | String | 공연장 이름 | "Broadway Theatre" |
| 공연장 최대 수용 수 | Integer | 좌석 수 | 932 |
| 티켓 가격 | Integer | 원화 기준 티켓 가격 | 50000 |
| 줄거리 | Text | 뮤지컬 줄거리 설명 | "This is..." |
| 공연 장르명 | String | 뮤지컬 장르 | "Historical" |


### 2. Musical_{N}_Casting_Board.csv(N: 뮤지컬 제목 | 아이디 1~ 해서 아이디 숫자로)
각 뮤지컬의 회차별 캐스팅 정보와 판매액을 담고 있는 파일
```
Musical_{N}_Casting_Board.csv
├── 관람일 (String: MM/DD(요일))
├── 시간 (Time: HH:MM)
├── 판매액 (Integer)
├── 역할명1 (String)
├── 역할명2 (String)
├── 역할명3 (String)
├── 역할명4 (String)
└── 역할명5 (String)
```
#### 컬럼 설명
| 컬럼명 | 데이터 타입 | 설명 | 예시 |
|--------|------------|------|------|
| 관람일 | String | MM/DD(요일) 형식의 공연 날짜 | "12/13(Fri)" |
| 시간 | Time | HH:MM 형식의 공연 시작 시간 | "19:00" |
| 판매액 | Integer | 해당 회차의 총 판매액 | 10164632 |
| 역할명1~5 | String | 출연 배우명 | "Actor Q" |


## 전처리 결과

### Combined_Musical_Data.csv
```
Combined_Musical_Data.csv
├── 기본 정보
│   ├── 뮤지컬 제목 (String)
│   ├── 관람일 (String: MM/DD)
│   ├── 관람요일 (String: Mon/Tue/Wed/Thu/Fri/Sat/Sun)
│   ├── 관람 시간 (Time: HH:MM)
│   └── 줄거리 (Text)
├── 공연 정보
│   ├── 공연 시설명 (String)
│   ├── 공연장 최대 수용 수 (Integer)
│   └── 공연 장르 (String: Drama/Romance/Historical/Comedy/Fantasy) ※ 추가 장르 논의
└── 판매 정보
    ├── 티켓 가격 (Integer)
    ├── 판매액 (Integer)
    ├── 일별 예매율 (Float: 0.0~100.0)
    └── 출연진 (String Array: "Actor A,Actor B,...")
```
※ 관람요일 모델에 돌릴 때 타입 오류가 자주 발생해서 그냥 String으로 넣음

| 컬럼명 | 데이터 타입 | 설명 | 예시 |
|--------|------------|------|------|
| 뮤지컬 제목 | String | 뮤지컬의 고유 제목 | "Musical_1" |
| 관람일 | String | MM/DD 형식의 공연 날짜 | "12/13" |
| 관람요일 | String | 요일 | "Fri" |
| 관람 시간 | Time | HH:MM 형식의 공연 시작 시간 | "19:00" |
| 티켓 가격 | Integer | 원화 기준 티켓 가격 | 50000 |
| 판매액 | Integer | 해당 회차의 총 판매액 | 10164632 |
| 일별 예매율 | Float | 계산된 예매율 (%) | 73.63 |
| 출연진 | String Array | 쉼표로 구분된 출연 배우 목록 | "Actor Q,Actor R,..." |
| 공연 시설명 | String | 공연장 이름 | "Broadway Theatre" |
| 공연장 최대 수용 수 | Integer | 좌석 수 | 932 |
| 줄거리 | Text | 뮤지컬 줄거리 설명 | "This is..." |
| 공연 장르 | String | 뮤지컬 장르 | "Historical" |



## 데이터 요구사항

### 1. 데이터 형식
- 모든 문자열은 UTF-8 인코딩
- 날짜/시간 형식 통일
- 금액은 원화 기준 정수
- 예매율은 소수점 2자리까지 표시(해당 내용은 전처리 후 내용)

### 2. 제약조건
- 결측치 없음(캐스팅 보드나 뮤지컬 데이터의 결측치 X)
- 예매율은 0~100 사이의 값

### 3. 데이터 정합성
- Musical_Data.csv의 공연 정보와 각 Casting_Board.csv의 회차 정보 일치
- 동일 뮤지컬의 공연장과 티켓가격은 일관성 유지(확인 필요)

### 4. 결론
- 총 좌석 수 데이터(아래 추가 설명)
- 일별 총 판매액 데이터(아래 추가 설명)
- 일별 예매율 ↔ 캐스팅 보드
- story(GPT 사용...?)
- 장르(현재 5개로 임의 분류: Historical, Romance, Drama, Fantasy, Comedy)
	→ 카테고리를 어찌할지 결정 필요



## 예매율 계산 방법

#### 현재 사용 중인 계산 방법
```python
일별 예매율 = (판매액 / (티켓 가격 * 최대 수용 수)) * 100
```

#### 개선된 계산 방법 (좌석 등급별 비율 추정)
좌석 등급별 가격과 비율을 고려한 예매율 계산 방법

##### [좌석 등급별 추정 가정]
1. 가격이 높은 좌석일수록 전체 좌석에서 차지하는 비율이 낮음
2. 티켓 가격에 따른 좌석 등급별 비율 예시:
   - VIP석: 20% (최고가)
   - R석: 30% (중간가)
   - S석: 50% (기본가)

#### 필요 데이터
※ 추출해서 값을 봐야 알겠지만 있는 것으로 보임
1. 총 좌석 수(O) <- API에 있는 것 확인: 6.2 박스오피스 조회 오퍼레이션
2. 일별 총 판매액(O) <- API에 있는 것 확인: 8.2 예매 통계 장르별 조회 오퍼레이션


##### 계산 방법
1. 최대 판매 가능액 계산
```python
최대 판매 가능액 = ∑(총 좌석 수 × 좌석 등급 비율 × 등급별 가격)
```

2. 일별 예매율 계산
```python
예매율 = (일별 총 판매액 / 최대 판매 가능액) × 100
```

3. 구현 예시
```python
total_seats = 1000  # 총 좌석 수
grades = [
    {"grade": "VIP", "price": 150000, "ratio": 0.2},  # VIP석 비율: 20%
    {"grade": "R", "price": 100000, "ratio": 0.3},   # R석 비율: 30%
    {"grade": "S", "price": 80000, "ratio": 0.5}     # S석 비율: 50%
]
daily_sales = 80000000  # 일별 총 판매액

# 최대 판매 가능액
max_sales = sum(total_seats * grade["ratio"] * grade["price"] for grade in grades)

# 예매율
booking_rate = (daily_sales / max_sales) * 100

print(f"일별 예매율: {booking_rate:.2f}%")
```

##### 장점
- 좌석 등급별 가격 차이 반영
- 더 현실적인 예매율 계산 가능
- 공연장 특성을 고려한 수익 분석 가능(차후..? 모델 분석 후 가격이 주는 영향력 분석이 필요할 듯)

##### 한계
- 실제 좌석 등급별 비율과 차이 발생 가능
- 공연장마다 다른 좌석 구성 미반영(시간 부족)
- 특별 할인이나 프로모션 미반영(현실적 불가)

##### 보완책
- 공연장별 실제 좌석 구성 데이터 활용(있는지 확인 필요)
- 시즌별/요일별 가격 변동 반영(시즌... 이것도 시간)
- 할인 정책 데이터 반영(안됨)

##### 보완책에 대한 추가 필요 데이터(이건 진짜 차후, 시간 남고 아 할 거 없는데 뭐하지? 게임도 재미없는데? 진짜 조퇴도 못하고.. 이제 뭐하지? 하면 하는거)
1. 좌석 정보
   - 공연장별 좌석 등급 구성(API에는 없는 것으로 확인)
   - 등급별 정확한 좌석 수(API에는 없는 것으로 확인)
   - 좌석 배치도(API에는 없는 것으로 확인)

2. 가격 정보
   - 등급별 기본 가격(이건 더미로 준 데이터에 있었음)
   - 할인 정책 정보(거부)
   - 시즌별/요일별 가격 변동 정보(거부)

3. 판매 정보
   - 등급별 실제 판매 현황(등급별은 없는 듯)
   - 할인/프로모션 적용 내역(안됨 거부 돌아가)
